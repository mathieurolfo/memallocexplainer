<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <title>Heap Allocator</title>

    <!-- Add Boostrap -->
	<!-- <link rel="stylesheet" type="text/css" href="main.css"> -->
    <!-- Col and row from the example code in class -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">

    <meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700" rel="stylesheet">
	<script type="text/javascript" src="components/3-first-fit/jquery.min.js"></script>
	<script type="text/javascript" src="components/3-first-fit/jquery-ui.min.js"></script>
	<script type="text/javascript" src="components/3-first-fit/fabric.min.js"></script>

	<!-- Add our own CSS and JS -->
	<link href="components/main.css" rel="stylesheet" type="text/css">
    <!-- <link href="components/drag-and-drop/interact.js" rel="stylesheet" type="text/css"> -->
    <script src="components/drag-and-drop/interact.js" defer></script>
    <link href="components/buttons.css" rel="stylesheet" type="text/css">

	<!-- Add individual sections -->

	<link href="components/1-intro/intro.css" rel="stylesheet" type="text/css">
    <script src="components/1-intro/intro.js" defer></script>
    <link href="components/2-malloc/malloc.css" rel="stylesheet" type="text/css">
    <script src="components/2-malloc/malloc.js" defer></script>
    <link href="components/6-segregated-freelist/segregated-freelist.css" rel="stylesheet" type="text/css">
    <script src="components/6-segregated-freelist/segregated-freelist.js" defer></script>
    <link href="components/7-play/play.css" rel="stylesheet" type="text/css">
    <script src="components/7-play/play.js" defer></script>

    <!-- <script src="components/3-first-fit/shared-fit-game-logic.js" defer></script> -->



    <script src="components/3-first-fit/first-fit.js"></script>
    <link href="components/3-first-fit/first-fit.css" rel="stylesheet" type="text/css">



    <link href="components/4-best-fit/best-fit.css" rel="stylesheet" type="text/css">
    <script src="components/4-best-fit/best-fit.js"></script>

    <link href="components/7-play/play.css" rel="stylesheet" type="text/css">
    <script src="components/7-play/play.js" defer></script>

    <link href="components/8-conclusion/conclusion.css" rel="stylesheet" type="text/css">
    <script src="components/8-conclusion/conclusion.js" defer></script>


</head>
<body>

	<header id="header">
      <div class="jumbotron">
        <div class="container">
          <h1 class="display-3">Heap Allocation</h1>
          <p class="lead" align="left">an interactive explanation</p>
          <p>We will teach you heap allocation strategies</p>
        </div>
      </div>
    </header>

    <section id="intro">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                <h2>We will teach you heap allocation.</h2>
              </div>
            </div>
        </div>
    </section>



	<section id="malloc">
		<div><div id="malloc-container" class="centered">
		<h2>Loading the Train</h2>
		<div id="malloc-description-text">
		In our explanation, we represent requests for memory allocation, called malloc in computer science terms, as placing cargo on train cars. To place cargo on a train, you will check train cars sequentially, and if they have enough space, press the button to load the cargo. Cargo can be placed on cars larger than them, but not cars smaller than them.
		</div>

		<div id="malloc-demo-1">
		<h5>Try and load the cargo!</h5>
		<div class="centered"><div id="malloc-cargo-box-1" class="malloc-cargo-box cargo-box">4</div></div>

		<img class="img img-fluid figure-head" id="figure-head-1" src="figures/train-head.svg"></img>
        <img class="img img-fluid figure-cart2" id="figure-cart2-1" src="figures/train-demo.svg"></img>

        <div><button id="demo-load-button-1" class="malloc-load-button button-pill button button-3d" onclick="demoLoadClicked1()">Load Cargo</button></div>
        </div>

        <div id="malloc-demo-2">

        	<div class="malloc-text centered">
        	Great, you placed the cargo! Now try with a cargo that is too big for the cart.
        	</div>

	        <div class="centered"><div id="malloc-cargo-box-2" class="malloc-cargo-box cargo-box">10</div></div>

			<img class="img img-fluid figure-head" id="figure-head-2" src="figures/train-head.svg"></img>
	        <img class="img img-fluid figure-cart2" id="figure-cart2-2" src="figures/train-demo.svg"></img>

	        <div><button id="malloc-load-button2" class=" malloc-load-button button button-3d button-pill" onclick="demoLoadClicked2()">Load Cargo</button></div>
	        </div>


        </div>

        <div id="malloc-section-end">
        <div class="malloc-text centered">
        It simply won't fit on the train car. If there isn't a train car big enough for the cargo, we won't be able to load it on the train and lose out on our profit!
	    </div>

	    <div class="malloc-text centered add-spacing">
        Now that we know the rules of the game, let's try and figure out the best way to load up our trains.
	    </div>

	    </div>

    </section>

	<!-- Matt -->

    <section id="first-fit">

    <div class="centered">
		<div id="first-fit-header-text">Load the train by placing cargo in the first space it fits!</div>
		<div id="first-fit-description-text" >
		The cargo is located on the left of the screen. You will have three pieces of cargo to place, and you can only see the size of the current piece of cargo. Browse through the train using the left and right arrows until you find a spot where the cargo fits. You can see your current speed and space usage at the bottom of the window.
		</div>
		<button id="first-fit-start-button" class=" malloc-load-button button button-3d button-pill" onclick="startFirstFit()">Got it!</button>
	</div>

    <div><div id="first-fit-game-container" class="centered">
		<!-- <span id="first-fit-cargo-display-region"> -->

			<!-- <div id="first-fit-cargo-display-header" class="display-header"></div> -->
			<!-- <div id="first-fit-current-cargo-size"></div> -->

			<!-- <div id="first-fit-cargo2" class="cargo-box centered">?</div>
			<div id="first-fit-cargo3" class="cargo-box centered">?</div> -->
		<!-- </span> -->
		<!-- <span id="first-fit-current-car-region"> -->
			<!-- <div id="first-fit-car-display-header" class="display-header"></div> -->
			<!-- <button id="button" onclick="buttonClicked()">place load</button> -->
			<!-- <div id="first-fit-car-display"> -->
				<!-- <button id="first-fit-left-button" class="button button-3d button-circle" onclick="firstfitleftClicked()"><</button> -->

				<!-- <button id="first-fit-right-button" class="button button-3d button-circle" onclick="firstfitrightClicked()">></button> -->
		<!-- 	</div>
		</span>
 -->
		<div>
		<h4>Does this cargo fit in this car?</h4>
		</div>


		<div id="first-fit-button-area">
			<div id="first-fit-yes-area">
					<button id="first-fit-yes-button" class="button button-3d button-pill" onclick="firstfitYesClicked()">Yes - Load</button>
			</div>

			<div id="first-fit-no-area">
				<button id="first-fit-no-button" class="button button-3d button-pill" onclick="firstfitNoClicked()">No - Next Car</button>
				<div>
			</div>
		</div>
		<div id="first-fit-current-cargo-box" ></div>
		<img class="" id="first-fit-arrow" src="figures/arrow.png"></img>

		<div id="first-fit-train-display-region" >
			<!-- <h5 class="centered"> Overview of the whole train:</h5> -->
			<canvas id="first-fit-train-display"></canvas>
		</div>

		<div id="first-fit-click-counter">
			<h3><span >Train cars inspected: </span><span id="first-fit-clicks"></span></h3>
		</div>
		<div id="first-fit-util-counter">
			<h3><span >Total train space used: </span><span id="first-fit-utilization"></span></h3>
		</div>

		<!-- <div class="centered">
			<div id="first-fit-car-capacity">hi</div>

				<div id="first-fit-message-box" ></div>
			</div>
		</div> -->

		<button id="first-fit-refresh-button" class="button" onclick="firstfitresetSimulation()">Refresh this Game</button>
		<!-- <div id="first-fit-car-display-header" class="display-header"></div>
		<canvas id="first-fit-current-train"></canvas> -->
	</div></div>

	<div id="first-fit-end-text" class="centered" name="first-fit-segue">
	The strategy we just tried out, placing the cargo in the first-fitting spot, has its strengths and weaknesses. On one hand, we are able to place a given piece of cargo pretty quickly: we placed the first two pieces of cargo after only looking at a single car! However, we couldn't make the best use of our train's available space: we had what is referred to as fragmentation. <br><br>Our final stats were <b>8 cars inspected</b> and <b>6/16 space utilization</b>: can we do better with a different strategy?

	<br><br><br>Instead of placing cargo in the first-fitting spot, what if we place it in the <i>best-fitting</i> spot? This will minimize the amount of small, leftover spaces in each train car, which we call fragmentation.<br>
	<button id="best-fit-start-button" class="centered malloc-load-button button button-3d button-pill" onclick="startBestFit()">Try Best Fit</button>
	</div>
	</section>
	<!--  best fit -->
     <section id="best-fit">
     <div class="centered">
		<!-- <div id="first-fit-header-text">Load the train by placing cargo in the first space it fits!</div>
		<div id="first-fit-description-text" >
		The cargo is located on the left of the screen. You will have three pieces of cargo to place, and you can only see the size of the current piece of cargo. Browse through the train using the left and right arrows until you find a spot where the cargo fits. You can see your current speed and space usage at the bottom of the window.
		</div>
		<button id="first-fit-start-button" class=" malloc-load-button button button-3d button-pill" onclick="startFirstFit()">Got it!</button>
	</div> -->

	<div><div id="best-fit-game-container" class="centered">
		<!-- <span id="first-fit-cargo-display-region"> -->

			<!-- <div id="first-fit-cargo-display-header" class="display-header"></div> -->
			<!-- <div id="first-fit-current-cargo-size"></div> -->

			<!-- <div id="first-fit-cargo2" class="cargo-box centered">?</div>
			<div id="first-fit-cargo3" class="cargo-box centered">?</div> -->
		<!-- </span> -->
		<!-- <span id="first-fit-current-car-region"> -->
			<!-- <div id="first-fit-car-display-header" class="display-header"></div> -->
			<!-- <button id="button" onclick="buttonClicked()">place load</button> -->
			<!-- <div id="first-fit-car-display"> -->
				<!-- <button id="first-fit-left-button" class="button button-3d button-circle" onclick="firstfitleftClicked()"><</button> -->

				<!-- <button id="first-fit-right-button" class="button button-3d button-circle" onclick="firstfitrightClicked()">></button> -->
		<!-- 	</div>
		</span>
 -->
		<div>
		<h4>Is this the best-fitting car for this cargo?</h4>
		</div>
		<div id="best-fit-current-cargo-box" ></div>

		<canvas id="best-fit-current-train"></canvas>

		<div id="best-fit-car-display-header" class="display-header"></div>
		<div id="best-fit-button-area">
			<div id="best-fit-yes-area">
					<button id="best-fit-yes-button" class="button button-3d button-pill" onclick="bestfitYesClicked()">Yes - Load</button>
			</div>

			<div id="best-fit-no-area">
				<button id="best-fit-no-button" class="button button-3d button-pill" onclick="bestfitNoClicked()">No - Next Car</button>
				<div>
			</div>
		</div>

		<div id="best-fit-train-display-region" >
			<h5 class="centered"> Overview of the whole train:</h5>
			<canvas id="best-fit-train-display"></canvas>
		</div>

		<div id="best-fit-click-counter">
			<h3><span >Train cars inspected: </span><span id="best-fit-clicks"></span></h3>
		</div>
		<div id="best-fit-util-counter">
			<h3><span >Total train space used: </span><span id="best-fit-utilization"></span></h3>
		</div>

		<!-- <div class="centered">
			<div id="first-fit-car-capacity">hi</div>

				<div id="first-fit-message-box" ></div>
			</div>
		</div> -->

		<button id="best-fit-refresh-button" class="button" onclick="bestfitresetSimulation()">Refresh this Game</button>

    </section>

	<section id="balance">
    </section>


	<section id="segregated-freelist">
        <div class="container" >
            <div class="row">
              <h5>Now let's create a cheat sheet! </h5>
              <div id="free-list-text" name="free-list-segue">
    Can you sort it into different bucket list by looking at each cart once? <br>Try drag the carts into different size list!
                </div>
              <p></p>

            </div>
            <div class="row">
                <div class="train" id="train-drag-drop-example" >
                </div>
            </div>
            <div class="row">
                <div class="col-md-12" align="center">
                <h4>Drag the empty train into different categories of sizes!</h4>
                </div>
            </div>

        </div>
    </section>

	<section id="play">
		<div class="centered">
			Load this cargo:
			<div id="seg-free-current-cargo-box" class="centered"></div>
		</div>

		<div class="centered">
			<table id="data" style="width:70%">
			  <tr>
			    <td style='width: 20%;'><button type="button">Bucket 1-4</button></td>
			    <td><canvas id="seg-free-bucket4-display"></canvas></td>
			  </tr>
			  <tr>
			    <td>Bucket 5-8</td>
			    <td><canvas id="seg-free-bucket8-display"></canvas></td>
			  </tr>
			  <tr>
			    <td>Bucket 9-12</td>
			    <td><canvas id="seg-free-bucket12-display"></canvas></td>
			  </tr>
			  <tr>
			    <td>Bucket 13-16</td>
			    <td><canvas id="seg-free-bucket16-display"></canvas></td>
			  </tr>
			</table>
		</div>
<!-- 
		<div class="centered">
			Load this cargo:
			<div id="seg-free-current-cargo-box" class="centered"></div>
		</div>
		<div class="centered">
			<span id="seg-free-cargo-display-region">
				<div class="centered">
					Choose a bucket
					<div>
					<button id="seg-free-load-button" class="button" onclick="bucketClicked(4)">1-4</button>
					</div>
					<div>
					<button id="seg-free-load-button" class="button" onclick="bucketClicked(8)">5-8</button>
					</div>
					<div>
					<button id="seg-free-load-button" class="button" onclick="bucketClicked(12)">9-12</button>
					</div>
					<div>
					<button id="seg-free-load-button" class="button" onclick="bucketClicked(16)">13-16</button>
					</div>
				</div>
			</span>

			<span id="seg-free-current-car-region">
				<div id="seg-free-car-display-header" class="display-header"></div>
				<div class="centered">
				</div>
				<div id="seg-free-car-display">
					<button id="seg-free-left-button" class="button button-circle" onclick="leftClickedSeg()"></button>
					<canvas id="seg-free-current-train"></canvas>
					<button id="seg-free-right-button" class="button button-circle" onclick="rightClickedSeg()">></button>
				</div>
				<div class="centered">
					<div id="seg-free-car-capacity">hi</div>
					<button id="seg-free-load-button" class="button" onclick="loadClickedSeg()">Load Cargo</button>
					<div>
						<div id="seg-free-message-box" ></div>
					</div>
				</div>

			</span>
		</div>
 -->
		<div id="seg-free-train-display-region">
			<div id="seg-free-click-counter">
				<span >Train cars inspected: </span><span id="seg-free-clicks"></span>
			</div>
			<div id="seg-free-util-counter">
				<span >Total train space used: </span><span id="seg-free-utilization"></span>
			</div>
			<canvas id="seg-free-train-display"></canvas>
		</div>
		<button id="seg-free-refresh-button" class="button" onclick="resetSimulationSeg()">Refresh this Game</button>
	</section>

	<section id="conclusion">
	</section>

	<footer class="mt-5 pt-5 pb-5" id="footer">
      <div class="container">
        <p class="lead text-muted">CS 247</p>
      </div>
    </footer>

  </body>
</html>
